---
title: 1
---

{% raw %}
Matrix is row wise and column wise sorted   
https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/description/

![image.png](/DTRANSFER/notebook_images/DTRANSFER_ADCLCHJC_1Algorithms_993SangamTpMmPQMergeSort_3Matrix_1__att_0001.png)

```python

int kthSmallest(vector<vector<int>>& ma, int k) {
    int n=ma.size();
    auto cmp=[&](auto &a, auto &b){
        int x=ma[a.first][a.second],y=ma[b.first][b.second];
        return x>y;
    };

    priority_queue<pair<int,int> ,vector<pair<int,int>>,decltype(cmp)> pq(cmp);

    pq.push({0,0});
    set<pair<int,int>> se; 
    se.insert({0,0});
    int ans=-1;
    while(k--){
        //see if auto can be used here
        pair<int,int> p=pq.top();
        pq.pop();
        int i=p.first,j=p.second;
        ans=ma[i][j];
        if(j+1<n and !se.count({i,j+1})){
            pq.push({i,j+1});
            se.insert({i,j+1});
        }
        
        if(i+1<n and !se.count({i+1,j})){
            pq.push({i+1,j});
            se.insert({i+1,j});
        }
    }
    return ans;        
}
```

![image.png](/DTRANSFER/notebook_images/DTRANSFER_ADCLCHJC_1Algorithms_993SangamTpMmPQMergeSort_3Matrix_1__att_0002.png)

![image.png](/DTRANSFER/notebook_images/DTRANSFER_ADCLCHJC_1Algorithms_993SangamTpMmPQMergeSort_3Matrix_1__att_0003.png)

```python
int findKthNumber(int rr, int cc, int k) {
    int l=1,h=rr*cc,ans=-1;
    while(l<=h){
        int m=(l+h)/2;
        if(f(m,rr,cc)>=k){
            ans=m;
            h=m-1;
        }
        else l=m+1;
    }
    return ans;
}

int f(int m, int rr, int cc){
    int ans=0;  
    for(int r=1;r<=rr;r++){
        ans+=min(m/r,cc);
    }
    return ans;
}
```

![image.png](/DTRANSFER/notebook_images/DTRANSFER_ADCLCHJC_1Algorithms_993SangamTpMmPQMergeSort_3Matrix_1__att_0004.png)
{% endraw %}
